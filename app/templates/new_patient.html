{% extends "base.html" %}
{% block content %}

<div class="np-container">

  <div class="breadcrumb">Dashboard / New Patient</div>
  <h1 class="np-title">Add New Patient</h1>
  <div class="np-divider"></div>

  <div class="np-tabs">
    <a href="/clinician/new-patient?step=a" class="tab {{ 'active' if step=='a' }}">A. BASIC INFO</a>
    <a href="/clinician/new-patient?step=b" class="tab {{ 'active' if step=='b' }}">B. VITAL SIGNS</a>
    <a href="/clinician/new-patient?step=c" class="tab {{ 'active' if step=='c' }}">C. LIFESTYLE</a>
    <a href="/clinician/new-patient?step=d" class="tab {{ 'active' if step=='d' }}">D. MEDICAL HISTORY</a>
  </div>

  <div class="np-panel">

    <div class="np-panel-head">
      {% if step=='a' %}A. BASIC INFORMATION{% endif %}
      {% if step=='d' %}D. MEDICAL HISTORY{% endif %}
    </div>

    <!-- STEP A -->
    {% if step=='a' %}
    <form method="post" action="/clinician/new-patient/create">

      <div class="np-grid-2">
        <div class="field">
          <label>FULL NAME *</label>
          <input type="text" name="full_name" required>
        </div>

        <div class="field">
          <label>NATIONAL ID *</label>
          <input type="text" name="national_id" required>
        </div>

        <div class="field">
          <label>DATE OF BIRTH *</label>
          <input type="date" name="date_of_birth" required>
        </div>

        <div class="field">
          <label>GENDER *</label>
          <select name="gender" required>
            <option value="">– Select –</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
          </select>
        </div>
      </div>

      <div class="btn-row">
        <button type="submit" class="np-btn">
          NEXT →
        </button>
      </div>

    </form>
    {% endif %}


    <!-- STEP D (ใช้ route new-visit แยกต่างหาก) -->
    {% if step=='d' %}
    <form method="post" action="/clinician/new-visit/{{ patient.id }}">

      <div class="np-grid-1">
        <div class="field">
          <label>CHRONIC DISEASES</label>
          <textarea name="chronic"></textarea>
        </div>

        <div class="field">
          <label>FAMILY HISTORY</label>
          <textarea name="family"></textarea>
        </div>

        <div class="field">
          <label>DRUG ALLERGIES</label>
          <textarea name="allergies"></textarea>
        </div>

        <div class="field">
          <label>CLINICIAN NOTES</label>
          <textarea name="notes"></textarea>
        </div>
      </div>

      <div class="btn-row">
        <button type="submit" class="np-btn">
          CALCULATE RISK & SAVE VISIT
        </button>
      </div>

    </form>
    {% endif %}

  </div>
</div>

{% endblock %}